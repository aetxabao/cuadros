# Ejercicios productor-consumidor: cuadros

En la situación inicial un pintor crea un cuadro en un periodo de tiempo entre uno y sesenta días a lo largo de un año y lo mete en un centro de exposición cada vez que lo crea. Al introducirse el cuadro en la exposición se incrementa el stock de la exposición y el contador de cuadros metidos. Además se notifica al marchante que podría estar en la cola de espera. El marchante mientras la expo no esté cerrada esperará a ser notificado en un Wait de un Monitor, si la expo no está cerrada y hay stock, el stock se decrementará y el contador de cuadros sacados se incrementará. El programa que simula las acciones tiene una clase para un reloj y expo comunes, así como para el pintor y el marchante. Cuando se ejecute el programa se instanciarán un objeto de cada clase y se pasará la instancia de la expo y el reloj al pintor y al marchante.  A continuación se iniciarán los hilos del pintor y el marchante hasta que el pintor finalice, momento en el cual se cerrará la expo que ejecutará un Pulse para sacar al marchante de la cola de espera si fuera el caso y que así este pueda finalizar su hilo. Hay que indicar en que fechas se meten y sacan cuadros y al final cuántos cuadros han sido metidos y sacados y el stock que queda en la expo. Entre 1 y 60 días se mete un cuadro (la media es 30 días), lo normal es que se saque en el mismo día y por consiguiente se metan y saquen al rededor de 12 cuadros dejando un stock de 0.


1.  Modificar el código para que en vez de utilizar el método Next de la clase Random para obtener cuándo se mete un cuadro se utilice una distribución normal a la cual hay que pasar como parámetros de inicio la media y la desviación estándar. Ejecutarlo varias veces con una media de 30 días y una desviación estándar de 15 días. El valor devuelto cada vez que se solicita el siguiente valor debe ser mayor o igual que cero. Mostrar las trazas y los logs finales.

2.  Suponer que la expo se puede iniciar con un stock y capacidad. Por ejemplo, que el stock inicial sea de 9 cuadros y la capacidad de 10, con lo cual inicialmente sólo puede entrar un cuadro más y si se mete y no se saca ninguno y se quiere meter otro, este tendrá que esperar. Se tienen que ejecutar tres simulaciones en las que el pintor crea de forma aleatoria un cuadro entre 1 y 60 días y el marchante en cada caso saca un cuadro cada 15 días, en otro caso en un periodo entre 30 y 60 días y en el caso final cada 60 días. En este ejercicio tanto el pintor como el marchante se pueden ver bloqueados, querer meter/sacar un cuadro y no poder hacerlo, y por consiguiente, permanecerán un tiempo a lo largo del año en la cola de espera de los hilos bloqueados. Estos tiempos se deben mostrar tras la ejecución  de las simulaciones junto al resto de información que se mostraba. Se indicará en qué fecha no se ha podido meter/sacar un cuadro. Mientras el pintor esté bloqueado esperando meter un cuadro no podrá crear y meter otros cuadros. De la misma forma, el marchante que espera sacar un cuadro no puede intentar sacar otro cuadro. En estos casos los hilos estarán en la cola de espera liberando el token mediante la sentencia Wait del Monitor. Cuando el stock es igual que la capacidad o igual a cero, según sea el caso del pintor o el marchante, se tomará el instante del tiempo mediante el reloj antes de ejecutar el Wait y luego el instante tras salir para sumar la diferencia, que es el tiempo en la cola de espera, al contador de tiempo de espera respectivo. Los intentos de sacar y meter estarán en un bucle hasta su consecución o que la expo se cierre. Cuando se logre meter o sacar un cuadro se hará un Pulse sobre el Monitor para notificar la acción.

3. En este caso se quiere realizar en cada ejecución del programa una sola simulación. El stock inicial es de 6  cuadros en una exposición con capacidad para 10 cuadros. Habrá tres pintores que producirán un cuadro en un periodo de 1 a 60 días uno de ellos, de 1 a 30 días otro y el último de 7 a 15 días. Respecto de los marchantes de arte habrá dos. Uno saca un cuadro con una periodicidad de 20 a 40 días y el otro de forma constante cada 7 días. Mostrar los cuadros totales metidos y sacados así como el stock final y cuánto tiempo han estado en total los pintores por una parte y los marchantes por otra parte parados.


Una posible solución de cada uno de los ejercicios se encuentra en cada una de las ramas del repositorio de GitHub.
